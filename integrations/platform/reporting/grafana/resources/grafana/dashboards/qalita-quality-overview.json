{
  "__inputs": [],
  "__requires": [
    { "type": "grafana", "id": "grafana", "name": "Grafana", "version": "10.4.5" },
    { "type": "panel", "id": "timeseries", "name": "Time series", "version": "10.4.5" },
    { "type": "datasource", "id": "postgres", "name": "PostgreSQL", "version": "1.0.0" }
  ],
  "title": "QALITA Quality Overview",
  "tags": ["qalita", "quality"],
  "timezone": "browser",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "30s",
  "panels": [
    {
      "id": 1,
      "gridPos": {"x": 0, "y": 0, "w": 12, "h": 8},
      "type": "timeseries",
      "title": "Completeness score (Project A / Sales)",
      "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT metric_date as time, metric_value FROM reporting.metrics_daily WHERE project = 'Project A' AND domain = 'Sales' AND metric_name = 'completeness_score' ORDER BY metric_date",
          "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"}
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "options": {
        "legend": {"displayMode": "list", "showLegend": true},
        "tooltip": {"mode": "single"}
      }
    },
    {
      "id": 2,
      "gridPos": {"x": 12, "y": 0, "w": 12, "h": 8},
      "type": "timeseries",
      "title": "Validity score (Project A / Sales)",
      "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT metric_date as time, metric_value FROM reporting.metrics_daily WHERE project = 'Project A' AND domain = 'Sales' AND metric_name = 'validity_score' ORDER BY metric_date",
          "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"}
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "options": {
        "legend": {"displayMode": "list", "showLegend": true},
        "tooltip": {"mode": "single"}
      }
    },
    {
      "id": 3,
      "gridPos": {"x": 0, "y": 8, "w": 8, "h": 8},
      "type": "stat",
      "title": "Open issues (Project A)",
      "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT COUNT(*) as value FROM reporting.issues WHERE project = 'Project A' AND status = 'open'",
          "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"}
        }
      ],
      "options": {"reduceOptions": {"values": false, "calcs": ["lastNotNull"]}},
      "fieldConfig": {"defaults": {"unit": "none"}, "overrides": []}
    },
    {
      "id": 4,
      "gridPos": {"x": 8, "y": 8, "w": 8, "h": 8},
      "type": "bargauge",
      "title": "Issues by severity (Project A)",
      "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT severity, COUNT(*) as count FROM reporting.issues WHERE project = 'Project A' AND status = 'open' GROUP BY severity",
          "datasource": {"type": "postgres", "uid": "QALITA Reporting (Postgres)"}
        }
      ],
      "options": {"orientation": "horizontal"}
    }
  ],
  "templating": {
    "list": []
  },
  "time": {"from": "now-90d", "to": "now"}
}


